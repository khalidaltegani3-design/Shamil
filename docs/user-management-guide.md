# دليل إدارة المستخدمين - نظام شامل

## نظرة عامة
تم تطوير نظام شامل لإدارة المستخدمين يسمح لمدير النظام بالتحكم الكامل في أدوار وصلاحيات جميع المستخدمين.

## الوصول إلى نظام الإدارة
- **الرابط**: `/admin/users`
- **المطلوب**: تسجيل الدخول كمدير نظام
- **مديرو النظام الحاليون**: 
  - Sweetdream711711@gmail.com (مدير النظام الأساسي)
  - أي مستخدم تم ترقيته لمدير نظام

## أمان الوصول
- الصفحة محمية ولا تظهر إلا لمديري النظام المعتمدين
- يتم التحقق من الصلاحيات تلقائياً عند دخول الصفحة
- المستخدمون غير المصرح لهم يتم توجيههم للصفحة الرئيسية

## الميزات الرئيسية

### 1. لوحة الإحصائيات
- **إجمالي المستخدمين**: عدد جميع المستخدمين المسجلين
- **الموظفون**: عدد الموظفين العاديين
- **المشرفون**: عدد المشرفين على الأقسام
- **المديرون**: عدد المديرين العامين

### 2. أدوات البحث والتصفية
- **البحث**: بالاسم أو البريد الإلكتروني
- **تصفية حسب الدور**: موظف، مشرف، مدير عام
- **تصفية حسب القسم**: جميع الأقسام المتاحة

### 3. إدارة أدوار المستخدمين

#### الترقيات المتاحة:
- **موظف → مشرف**: ترقية الموظف العادي إلى مشرف
- **مشرف → مدير عام**: ترقية المشرف إلى مدير عام
- **موظف → مدير عام**: ترقية مباشرة للموظف المتميز
- **مدير عام → مدير نظام**: ترقية المدير العام إلى مدير نظام (صلاحيات كاملة)

#### التنزيلات المتاحة:
- **مشرف → موظف**: تنزيل المشرف مع إزالة جميع صلاحيات الإشراف
- **مدير عام → موظف**: تنزيل المدير العام إلى موظف عادي

### 4. إدارة صلاحيات الإشراف
- **إضافة صلاحيات**: منح المستخدم صلاحية الإشراف على أقسام محددة
- **إزالة صلاحيات**: إلغاء صلاحية الإشراف عن أقسام معينة
- **إدارة متقدمة**: تحديد الأقسام التي يشرف عليها كل مشرف

### 5. إدارة حالة المستخدمين
- **تفعيل/إلغاء تفعيل**: التحكم في وصول المستخدمين للنظام
- **تغيير الأقسام**: نقل المستخدمين بين الأقسام المختلفة

## التدفق الافتراضي للمستخدمين الجدد

### 1. التسجيل
- جميع المستخدمين الجدد يسجلون كـ **موظفين** بشكل افتراضي
- يجب اختيار القسم أثناء التسجيل
- الحساب ينشأ بحالة "نشط" تلقائياً

### 2. الترقية
- مدير النظام يمكنه ترقية أي موظف إلى مشرف
- يمكن إضافة صلاحيات إشراف على أقسام محددة
- الترقية لمدير عام تعطي صلاحيات شاملة

### 3. إدارة الصلاحيات
- المشرفون يحصلون على صلاحيات محددة حسب الأقسام
- المديرون العامون لديهم صلاحيات كاملة
- مدير النظام له صلاحيات مطلقة على كل شيء

## أدوار المستخدمين

### مدير النظام (System Admin)
- **البريد الأساسي**: Sweetdream711711@gmail.com
- **الصلاحيات**: مطلقة على جميع أجزاء النظام
- **الوصول**: جميع الواجهات (موظف، مشرف، مدير، إدارة)
- **ملاحظة**: يمكن إضافة مديري نظام جدد عن طريق ترقية المديرين العامين

### المدير العام (Admin)
- **الصلاحيات**: إدارة شاملة للتقارير والموظفين
- **الوصول**: واجهة المشرف + إمكانيات إضافية
- **القيود**: لا يمكنه تعديل إعدادات النظام الأساسية
- **إمكانية الترقية**: يمكن ترقيته لمدير نظام

### المشرف (Supervisor)
- **الصلاحيات**: الإشراف على أقسام محددة
- **الوصول**: واجهة المشرف لأقسامه فقط
- **المهام**: مراجعة التقارير، إدارة الموظفين في قسمه

### الموظف (Employee)
- **الصلاحيات**: إنشاء التقارير والوصول للبيانات الأساسية
- **الوصول**: واجهة الموظف فقط
- **المهام**: إنشاء وتتبع التقارير الخاصة به

## خطوات الاستخدام

### لترقية موظف إلى مشرف:
1. اذهب إلى `/admin/users`
2. ابحث عن المستخدم المطلوب
3. اضغط على "ترقية لمشرف" في عمود الإجراءات
4. اضغط "إدارة الصلاحيات" لتحديد الأقسام
5. اختر الأقسام التي سيشرف عليها

### لإضافة مدير نظام جديد:
1. ابحث عن المدير العام المطلوب ترقيته
2. اضغط على "ترقية لمدير نظام" (الزر الأحمر)
3. سيحصل المستخدم على صلاحيات كاملة للنظام
4. سيتمكن من الوصول لصفحة إدارة المستخدمين

### لحذف مدير نظام:
⚠️ **تحذير**: لا يمكن تنزيل مديري النظام عبر الواجهة لضمان الأمان
- يجب التواصل مع المطور لحذف مدير نظام إذا لزم الأمر

### لإدارة صلاحيات الإشراف:
1. اضغط "إدارة الصلاحيات" بجانب اسم المستخدم
2. في النافذة المنبثقة، اختر الأقسام
3. ضع علامة ✓ لإضافة الصلاحية
4. أزل العلامة لإلغاء الصلاحية

## ملاحظات مهمة

### أمان النظام:
- مدير النظام محمي من التعديل أو الحذف
- جميع العمليات مسجلة مع الوقت والتاريخ
- كلمات المرور محمية بتشفير Firebase

### قواعد العمل:
- لا يمكن للمستخدم ترقية نفسه
- المشرف لا يمكنه ترقية أحد خارج نطاق صلاحياته
- مدير النظام فقط يمكنه إنشاء مديرين عامين جدد

### النسخ الاحتياطي:
- جميع البيانات محفوظة في Firestore
- التغييرات فورية ومزامنة عبر جميع الواجهات
- لا حاجة لإعادة تحميل الصفحة لرؤية التحديثات

## الدعم التقني
في حالة وجود مشاكل أو أسئلة:
1. تحقق من وجود اتصال بالإنترنت
2. تأكد من صحة صلاحيات المستخدم
3. راجع رسائل الأخطاء في وحدة التحكم
4. اتصل بالدعم التقني إذا استمرت المشكلة